I"<p>Tutorial for setup environment for lua</p>

<ol>
  <li>
    <p>Install cudatoolkit 8.0 and cudnn 5.1</p>

    <p>If you are setting environment on Suzhou HPC, you can use the following command to add them to your environment.</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module add cuda/8.0 cudnn/5.1
</code></pre></div>    </div>

    <p>Otherwise, you need to download the cudatoolkit install runfile from nvidia website https://developer.nvidia.com/cuda-80-download-archive and install it manually. Don’t use anaconda to install, it won’t work.</p>

    <p>And for cudnn, you need to register a nvidia developer account (free), and then download it from https://developer.nvidia.com/rdp/cudnn-archive</p>

    <p>Remember to download cuDNN v5.1 (Jan 20, 2017), for CUDA 8.0</p>
  </li>
  <li>
    <p>Set cudnn path:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">CUDNN_PATH</span><span class="o">=</span>/mnt/lustre/cm/shared/global/src/dev/cudnn/5.1/lib64/libcudnn.so.5
</code></pre></div>    </div>

    <p>(depends on where you install the cudnn library)</p>
  </li>
  <li>
    <p>Install OpenBLAS:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/xianyi/OpenBLAS.git
<span class="nb">cd </span>OpenBLAS
make <span class="nv">NO_AFFINITY</span><span class="o">=</span>1 <span class="nv">USE_OPENMP</span><span class="o">=</span>1
<span class="nb">sudo </span>make <span class="nv">PREFIX</span><span class="o">=[</span>path you want to <span class="nb">install </span>OpenBLAS] <span class="nb">install</span>
</code></pre></div>    </div>

    <p>Set environment variable:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">CMAKE_LIBRARY_PATH</span><span class="o">=[</span>path you <span class="nb">install </span>OpenBLAS]/include:[path you <span class="nb">install </span>OpenBLAS]/lib:<span class="nv">$CMAKE_LIBRARY_PATH</span>
</code></pre></div>    </div>

    <p>(Mind the line break while copying)</p>
  </li>
  <li>
    <p>Install torch7:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/torch/distro.git ~/torch <span class="nt">--recursive</span>
<span class="nb">cd</span> ~/torch./install.sh
</code></pre></div>    </div>
  </li>
  <li>
    <p>Install cudnn for lua:</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/soumith/cudnn.torch.git <span class="nt">-b</span> R5
<span class="nb">cd </span>cudnn.torch
luarocks make cudnn-scm-1.rockspec
</code></pre></div>    </div>
  </li>
  <li>
    <p>Install luarocks to make torch work with cuda:</p>

    <p>luarocks install cutorch</p>

    <p>luarocks install cunn</p>
  </li>
  <li>
    <p>If you want to install other lua libraries:luarocks install [library you need] All set. You should be able to use torch7 with lua now!For more information about torch, check this website: http://torch.ch/docs/getting-started.html#_</p>
  </li>
</ol>
:ET